<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden relative w-full h-full flex flex-col">
  <!-- Imagen del producto -->
  <div class="relative w-full aspect-square bg-gray-100 flex items-center justify-center overflow-hidden">
    <!-- Badge de descuento -->
    <div *ngIf="hasDiscount" class="absolute top-3 left-3 z-10 bg-red-500 text-white px-2.5 py-1 rounded-full text-xs font-bold shadow-lg">
      -{{ discountPercentage }}%
    </div>
    <img 
      [src]="product.image" 
      [alt]="product.name"
      class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
      [routerLink]="['/productos', product.id]">
    <app-product-favorite [productId]="product.id"></app-product-favorite>
  </div>
  
  <!-- Contenido -->
  <div class="p-4 flex flex-col flex-grow">
    <!-- Nombre -->
    <h3 class="text-lg font-bold text-gray-900 mb-2">{{ product.name }}</h3>

    <!-- Precio con descuento -->
    <div class="flex items-center gap-2 mb-2">
      <div class="flex flex-col">
        <div class="flex items-center gap-2">
          <p class="text-xl font-bold text-gray-900">${{ finalPrice | number:'1.2-2' }}</p>
          <p *ngIf="hasDiscount" class="text-sm text-gray-400 line-through">${{ originalPrice | number:'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Descripción -->
    <p class="text-sm text-gray-600 mb-3 line-clamp-2">
      {{ product.description || 'Lorem ipsum dolor sit amet consectetur. Eleifend nec morbi tellus vitae leo nunc.' }}
    </p>

    <!-- Rating con estrellas verdes -->
    <div class="flex items-center gap-1 mb-4">
      <svg 
        *ngFor="let star of getStarsArray(product.rating); let i = index"
        width="16" 
        height="16" 
        viewBox="0 0 24 24" 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg">
        <path 
          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" 
          fill="#22c55e" />
      </svg>
      <span class="text-sm text-gray-700">({{ product.reviews }})</span>
    </div>

    <!-- Botón Add to Cart -->
    <button 
      type="button"
      class="w-full flex items-center justify-center gap-2 py-2.5 px-4 border border-gray-900 rounded-full text-gray-900 font-medium hover:bg-gray-50 transition-colors mt-auto">
      <svg 
        width="18" 
        height="18" 
        viewBox="0 0 24 24" 
        fill="none" 
        stroke="currentColor" 
        stroke-width="2" 
        stroke-linecap="round" 
        stroke-linejoin="round">
        <circle cx="9" cy="21" r="1"/>
        <circle cx="20" cy="21" r="1"/>
        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
      </svg>
      <span>Add to Cart</span>
    </button>
  </div>
</div>
