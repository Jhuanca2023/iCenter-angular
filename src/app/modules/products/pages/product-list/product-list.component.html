<div class="bg-gray-50 py-8">
  <div class="container mx-auto px-4">
    <!-- Breadcrumb -->
    <div class="mb-6">
      <p class="text-sm text-gray-600">
        <a routerLink="/" class="hover:text-indigo-500">INICIO</a> /
        <span class="text-gray-900 font-medium"> PRODUCTOS</span>
      </p>
    </div>

    <!-- Título -->
    <div class="mb-4 sm:mb-6">
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">Todos los productos</h1>
      <p class="text-sm sm:text-base text-gray-600">Encuentra exactamente lo que necesitas</p>
    </div>

    <!-- Barra de búsqueda y ordenamiento -->
    <div class="flex flex-col sm:flex-row gap-3 items-stretch sm:items-center mb-4 sm:mb-6">
      <app-product-search (searchChange)="onSearchChange($event)"></app-product-search>
      <div class="flex gap-3">
        <app-product-sort (sortChange)="onSortChange($event)"></app-product-sort>
        <!-- Botón Filtros para mobile -->
        <button
          type="button"
          (click)="openFilterModal()"
          class="lg:hidden flex items-center justify-center gap-2 px-4 py-2.5 bg-purple-50 text-purple-700 font-medium rounded-lg hover:bg-purple-100 transition active:scale-95 w-full sm:w-auto">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="4" y1="21" x2="4" y2="14"/>
            <line x1="4" y1="10" x2="4" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12" y2="3"/>
            <line x1="20" y1="21" x2="20" y2="16"/>
            <line x1="20" y1="12" x2="20" y2="3"/>
            <line x1="1" y1="14" x2="7" y2="14"/>
            <line x1="9" y1="8" x2="15" y2="8"/>
            <line x1="17" y1="16" x2="23" y2="16"/>
          </svg>
          <span>Filtros</span>
        </button>
      </div>
    </div>

    <div class="flex flex-col lg:flex-row gap-6">
      <!-- Sidebar de filtros (solo desktop) -->
      <aside class="hidden lg:block w-full lg:w-64 flex-shrink-0">
        <app-filter-bar
          [categories]="categories"
          [brands]="brands"
          [minPrice]="0"
          [maxPrice]="5000"
          (filtersChange)="onFiltersChange($event)"
          (clearFilters)="onClearFilters()">
        </app-filter-bar>
      </aside>

      <!-- Contenido principal -->
      <div class="flex-1">
        <!-- Información de resultados -->
        <div class="flex items-center justify-between mb-4 sm:mb-6">
          <p class="text-sm sm:text-base text-gray-600">
            <span class="font-medium text-gray-900">{{ filteredProducts.length }}</span> productos encontrados
          </p>
        </div>

        <!-- Grid de productos -->
        <div *ngIf="filteredProducts.length > 0" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
          <app-product-card *ngFor="let product of filteredProducts" [product]="product" class="h-full"></app-product-card>
        </div>

        <!-- Mensaje cuando no hay productos -->
        <div *ngIf="filteredProducts.length === 0" class="text-center py-16">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-4 text-gray-400">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
          <h3 class="text-xl font-bold text-gray-900 mb-2">No se encontraron productos</h3>
          <p class="text-gray-600">No hay productos que coincidan con tu búsqueda o filtros seleccionados.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Filtros para Mobile -->
  <div 
    *ngIf="isFilterModalOpen" 
    class="fixed inset-0 z-[9999] lg:hidden"
    (click)="closeFilterModal()">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    
    <!-- Modal Content -->
    <div 
      class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl max-h-[90vh] overflow-y-auto"
      (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-4 flex items-center justify-between z-10">
        <h3 class="text-lg font-bold text-gray-900">Filtros</h3>
        <button
          type="button"
          (click)="closeFilterModal()"
          class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-900 transition">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6 6 18"/>
            <path d="m6 6 12 12"/>
          </svg>
        </button>
      </div>

      <!-- Content -->
      <div class="p-4 space-y-6">
        <!-- Categorías -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-3">Tipo de dispositivo</label>
          <div class="space-y-2">
            <label *ngFor="let category of categories" class="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                [checked]="isCategorySelected(category)"
                (change)="toggleCategory(category)"
                class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
              <span class="text-sm text-gray-700">{{ category }}</span>
            </label>
          </div>
        </div>

        <!-- Marcas -->
        <div *ngIf="brands && brands.length > 0">
          <label class="block text-sm font-semibold text-gray-900 mb-3">Marcas</label>
          <div class="space-y-2">
            <label *ngFor="let brand of brands" class="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                [checked]="isBrandSelected(brand)"
                (change)="toggleBrand(brand)"
                class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
              <span class="text-sm text-gray-700">{{ brand }}</span>
            </label>
          </div>
        </div>

        <!-- Precio -->
        <div>
          <label class="block text-sm font-semibold text-gray-900 mb-3">PRECIO</label>
          <div class="space-y-3">
            <div class="flex items-center gap-2">
              <input
                type="number"
                [(ngModel)]="tempPriceRange.min"
                [min]="0"
                [max]="5000"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900"
                placeholder="Mín">
              <span class="text-gray-500 text-sm">-</span>
              <input
                type="number"
                [(ngModel)]="tempPriceRange.max"
                [min]="0"
                [max]="5000"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900"
                placeholder="Máx">
            </div>
          </div>
        </div>
      </div>

      <!-- Footer con botones -->
      <div class="sticky bottom-0 bg-white border-t border-gray-200 px-4 py-4 flex gap-3">
        <button
          type="button"
          (click)="onClearFilters()"
          class="flex-1 py-3 px-4 bg-purple-50 text-purple-700 font-medium rounded-lg hover:bg-purple-100 transition active:scale-95">
          Borrar filtros
        </button>
        <button
          type="button"
          (click)="applyFiltersFromModal()"
          class="flex-1 py-3 px-4 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 transition active:scale-95 flex items-center justify-center gap-2">
          <span>Ver resultados</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>
